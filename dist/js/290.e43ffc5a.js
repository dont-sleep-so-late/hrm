"use strict";(self["webpackChunkGDUOHRM"]=self["webpackChunkGDUOHRM"]||[]).push([[290],{5290:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"DocumentCheck"},[t("el-card",[t("el-table",{attrs:{data:e.userlist,border:""}},[t("el-table-column",{attrs:{type:"index",label:"编号",width:"100"}}),t("el-table-column",{attrs:{prop:"profession",label:"职位","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"name",label:"姓名","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"o1Name",label:"一级机构","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"o2Name",label:"二级机构","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"o3Name",label:"三级机构","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"sex",label:"性别","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.showEditDialog(s.row)}}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.removeUserById(s.row.fid)}}})]}}])})],1),t("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[5,10,20,50],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChanged,"current-change":e.handleCurrentChange}}),t("el-dialog",{attrs:{title:"添加职位",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[t("el-form",{ref:"addFormRef",attrs:{model:e.addForm,rules:e.addFormRules,"label-width":"70px"}},[t("el-form-item",{attrs:{label:"职位名",prop:"username"}},[t("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"档案复核",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.editDialogClosed}},[t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.reject}},[e._v("驳 回")]),t("el-button",{attrs:{type:"primary"},on:{click:e.editUserInfo}},[e._v("通 过")])],1),t("el-form",{ref:"editFormRef",attrs:{model:e.editForm,"label-width":"100px"}},[t("el-image",{staticStyle:{width:"180px",height:"180px",transform:"translateX(140%)"},attrs:{src:e.editForm.image}}),t("el-form-item",{attrs:{label:"职位名称"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.profession,callback:function(t){e.$set(e.editForm,"profession",t)},expression:"editForm.profession"}})],1),t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),t("el-form-item",{attrs:{label:"所属一级机构"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.o1Name,callback:function(t){e.$set(e.editForm,"o1Name",t)},expression:"editForm.o1Name"}})],1),t("el-form-item",{attrs:{label:"所属二级机构"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.o2Name,callback:function(t){e.$set(e.editForm,"o2Name",t)},expression:"editForm.o2Name"}})],1),t("el-form-item",{attrs:{label:"所属三级机构"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.o3Name,callback:function(t){e.$set(e.editForm,"o3Name",t)},expression:"editForm.o3Name"}})],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-input",{attrs:{disabled:""},model:{value:e.editForm.sex,callback:function(t){e.$set(e.editForm,"sex",t)},expression:"editForm.sex"}})],1)],1)],1)],1)],1)},o=[],a={name:"DocumentCheck",data(){return{queryInfo:{query:"",pagenum:0,pagesize:5},userlist:[],total:0,addDialogVisible:!1,addForm:{username:"",password:"",email:"",mobile:""},addFormRules:{username:[{required:!0,message:"请输入职位名",trigger:"blur"},{min:2,max:10,message:"用户名的长度在2~10个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"用户名的长度在6~15个字符之间",trigger:"blur"}]},editDialogVisible:!1,editForm:{},setRolesDialogVisible:!1,userInfo:{},rolesList:[],selectedRoleId:""}},methods:{async getDocumentList(){const{data:e}=await this.$http.post(`/File/listFileRechecked?pageNum=${this.queryInfo.pagenum}&pageSize=${this.queryInfo.pagesize}`);console.log(e.data),this.userlist=e.data,this.total=1},async getUserListByName(){this.queryInfo.pagenum=0;const{data:e}=await this.$http.post(`/Sys/position/queryProfessionByProfession/${this.queryInfo.query}/${this.queryInfo.pagenum}/${this.queryInfo.pagesize}`);console.log(e.data),this.userlist=e.data,this.total=1},handleSizeChanged(e){this.queryInfo.pagesize=e,this.getDocumentList()},handleCurrentChange(e){console.log(this.queryInfo.pagenum),this.queryInfo.pagenum=e-1,this.getDocumentList()},async userStateChanged(e){const{data:t}=await this.$http.put(`users/${e.id}/state/${e.mg_state}`);if(200!==t.meta.status)return e.mg_state=!e.mg_state,this.$message.error("更新用户状态失败！");this.$message.success("更新用户状态成功！")},addDialogClosed(){this.$refs.addFormRef.resetFields()},addUser(){this.$refs.addFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post(`/Sys/position/insertProfession?profession=${this.addForm.username}`);this.$message.success("添加用户成功!"),this.addDialogVisible=!1,this.getDocumentList()}))},async showEditDialog(e){this.editDialogVisible=!0,window.sessionStorage.setItem("fid",e.fid),this.editForm=e,""==this.editForm.image&&(this.editForm.image="https://avatars.githubusercontent.com/u/47170023?v=4"),this.editDialogVisible=!0},editDialogClosed(){this.$refs.editFormRef.resetFields()},async reject(){const{data:e}=await this.$http.post(`/File/check/updateCheckFalseInfoByFid/${window.sessionStorage.getItem("id")}`);this.editDialogVisible=!1},editUserInfo(){this.$refs.editFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post(`/File/check/updateCheckInfoByFid/${window.sessionStorage.getItem("fid")}`);this.editDialogVisible=!1,this.getDocumentList(),this.$message.success("审核成功！")}))},async removeUserById(e){const t=await this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch((e=>e));if("confirm"!==t)return this.$message.info("已取消删除");const{data:s}=await this.$http.post(`/File/add/deleteInfoByFid/${e}`);this.$message.success("删除用户成功！"),this.getDocumentList()},async setRole(e){this.userInfo=e;const{data:t}=await this.$http.get("roles");if(200!==t.meta.status)return this.$message.error("获取角色列表失败！");this.rolesList=t.data,this.setRolesDialogVisible=!0},async saveRoleInfo(){if(!this.selectedRoleId)return this.$message.error("请选择要分配的角色!");const{data:e}=await this.$http.put(`users/${this.userInfo.id}/role`,{rid:this.selectedRoleId});if(200!==e.meta.status)return this.$message.error("更新角色失败！");this.$message.success("更新角色成功！"),this.getDocumentList(),this.setRolesDialogVisible=!1},setRoleDialogClosed(){this.selectedRoleId="",this.userInfo={}}},created(){this.getDocumentList()}},l=a,r=s(1001),n=(0,r.Z)(l,i,o,!1,null,"5289ec54",null),d=n.exports}}]);
//# sourceMappingURL=290.e43ffc5a.js.map